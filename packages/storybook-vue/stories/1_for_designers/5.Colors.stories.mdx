import { Meta, Description, DocsContainer } from '@storybook/addon-docs/blocks';
import index from '../telekom-design-tokens.light.json';

import text_en from './5.Colors_en.md';
import text_de from './5.Colors_de.md';

<Meta
  title="Scale for Designers/Colors"
  parameters={{
    docs: {
      container: ({ context }) => {
        const tinycolor = require('tinycolor2');
        const locale = context && context.globals && context.globals.locale;
        let newSection = false;
        let pathStringItem = [];
        let currentSection;
        let contrastSections;
        function getItemPathByPath(path) {
          for (let i = 0; i < 100; i++) {
            if (index.tokens[i].pathString === path) {
              if (index.tokens[i].path[3]) {
                return (
                  index.tokens[i].path[2] + ' / ' + index.tokens[i].path[3]
                );
              }
              return index.tokens[i].path[2];
            }
          }
        }
        function getItemColorByPath(path) {
          for (let i = 0; i < 100; i++) {
            if (index.tokens[i].pathString === path) {
              return index.tokens[i].value;
            }
          }
        }
        function getAllSections(items) {
          let itemPaths = [];
          let sections = [];
          let currentSection;
          items.map((path) => itemPaths.push(getItemPathByPath(path)));
          for (let i = 0; i < itemPaths.length; i++) {
            if (itemPaths[i].includes('/')) {
              if (sections.length == 0) {
                currentSection = itemPaths[i].substr(
                  0,
                  itemPaths[i].indexOf('/')
                );
                sections.push(
                  itemPaths[i].substr(0, itemPaths[i].indexOf('/'))
                );
              } else {
                if (
                  currentSection !==
                  itemPaths[i].substr(0, itemPaths[i].indexOf('/'))
                ) {
                  sections.push(
                    itemPaths[i].substr(0, itemPaths[i].indexOf('/'))
                  );
                  currentSection = itemPaths[i].substr(
                    0,
                    itemPaths[i].indexOf('/')
                  );
                }
              }
            }
          }
          contrastSections = sections;
        }
        function isNewSection(jsonPosition) {
          if (jsonPosition !== 0) {
            if (
              index.tokens[jsonPosition - 1].section !==
              index.tokens[jsonPosition].section
            ) {
              newSection = true;
              currentSection = index.tokens[jsonPosition].section;
            } else {
              newSection = false;
            }
          } else {
            newSection = true;
            currentSection = index.tokens[jsonPosition].section;
          }
        }
        function hasContrastWithoutSlash(items) {
          let itemPaths = [];
          items.map((item) => {
            itemPaths.push(getItemPathByPath(item));
          });
          for (let i = 0; i < itemPaths.length; i++) {
            if (!itemPaths[i].includes('/')) {
              return true;
            }
          }
        }
        function hasContrastColor(item) {}
        function isReadable(firstColor, secondColor) {
          if (
            tinycolor.isReadable(firstColor, secondColor, {
              level: 'AAA',
              size: 'small',
            })
          ) {
            return ' (AAA)';
          }
          if (
            tinycolor.isReadable(firstColor, secondColor, {
              level: 'AA',
              size: 'small',
            })
          ) {
            return ' (AA)';
          }
          return '';
        }
        return (
          <DocsContainer context={context}>
            <table>
              {index.tokens
                .filter((item) => item.category == 'Color')
                .map((item, i) => {
                  isNewSection(i);
                  {
                    item.contrastChecks
                      ? (pathStringItem = item.contrastChecks)
                      : null;
                  }
                  return (
                    <div>
                      {newSection ? (
                        <h1 style={{ marginTop: '100px' }}>{item.section}</h1>
                      ) : null}
                      {newSection ? (
                        <thead>
                          <tr>
                            <th
                              style={{
                                textAlign: 'left',
                                color: '#6A6A6A',
                                fontSize: '13px',
                              }}
                            >
                              Value
                            </th>
                            <th
                              style={{
                                textAlign: 'left',
                                color: '#6A6A6A',
                                fontSize: '13px',
                              }}
                            >
                              Comment
                            </th>
                            <th
                              style={{
                                textAlign: 'left',
                                color: '#6A6A6A',
                                fontSize: '13px',
                              }}
                            >
                              CSS-Variable Name
                            </th>
                          </tr>
                        </thead>
                      ) : null}
                      <tbody>
                        <tr>
                          {/* Value Column */}
                          <td
                            style={{
                              border: 'none',
                              verticalAlign: 'top',
                              width: '200px',
                            }}
                          >
                            {item.contrastChecks ? (
                              <div
                                style={{
                                  backgroundColor: `${item.value}`,
                                  padding: '20px',
                                  marginTop: '10px',
                                  border: '1px solid #f0f1f1',
                                  borderRadius: '4px',
                                  minWidth: '350px',
                                  minHeight: '120px',
                                }}
                              >
                                <div
                                  style={{
                                    color: `${getItemColorByPath(
                                      pathStringItem[0]
                                    )}`,
                                    fontSize: '12px',
                                    padding: '0px 0px 10px 0px',
                                  }}
                                >
                                  Recommended colors for text & icons
                                </div>
                                {hasContrastWithoutSlash(pathStringItem) ? (
                                  <td
                                    style={{
                                      padding: '0px 18px 0px 0px',
                                      border: 'none',
                                    }}
                                  >
                                    {pathStringItem
                                      .filter(
                                        (path) =>
                                          !getItemPathByPath(path).includes('/')
                                      )
                                      .map((path) => {
                                        return (
                                          <a href={`#${path}`}>
                                            <div
                                              style={{
                                                color: `${getItemColorByPath(
                                                  path
                                                )}`,
                                                fontSize: '14px',
                                              }}
                                            >
                                              {getItemPathByPath(path)}
                                            </div>
                                          </a>
                                        );
                                      })}
                                  </td>
                                ) : null}
                                {getAllSections(pathStringItem)}
                                {contrastSections
                                  ? contrastSections.map((item, i) => {
                                      return (
                                        <td
                                          style={{
                                            border: 'none',
                                            padding: '0px 18px 0px 0px',
                                          }}
                                        >
                                          {pathStringItem
                                            .filter((path) =>
                                              getItemPathByPath(path).includes(
                                                `${contrastSections[i]}`
                                              )
                                            )
                                            .map((path) => {
                                              return (
                                                <a href={`#${path}`}>
                                                  <div
                                                    style={{
                                                      color: `${getItemColorByPath(
                                                        path
                                                      )}`,
                                                      fontSize: '14px',
                                                    }}
                                                  >
                                                    {getItemPathByPath(path)}
                                                  </div>
                                                </a>
                                              );
                                            })}
                                        </td>
                                      );
                                    })
                                  : null}
                              </div>
                            ) : (
                              <div
                                style={{
                                  backgroundColor: `${item.value}`,
                                  padding: '20px',
                                  marginTop: '10px',
                                  border: '1px solid #f0f1f1',
                                  borderRadius: '4px',
                                  width: '350px',
                                  minHeight: '120px',
                                }}
                              ></div>
                            )}
                          </td>
                          {/* Comment Column */}
                          <td
                            style={{
                              verticalAlign: 'top',
                              width: '00px',
                              height: 'inherit',
                              border: 'none',
                            }}
                          >
                            <div
                              style={{
                                marginTop: '7px',
                                marginBottom: '7px',
                                width: '400px',
                              }}
                            >
                              <div>
                                <span
                                  style={{
                                    fontWeight: 'bolder',
                                    fontSize: '18px',
                                  }}
                                >
                                  {item.name}
                                </span>
                              </div>
                              <div>
                                <span
                                  style={{
                                    fontSize: '14px',
                                  }}
                                >
                                  {item.comment}
                                </span>
                              </div>
                            </div>
                          </td>
                          {/* CSS-Variable Name Column */}
                          <td
                            style={{
                              verticalAlign: 'top',
                              border: 'none',
                            }}
                          >
                            <div
                              style={{ fontWeight: '500', fontSize: '13px' }}
                            >
                              css
                            </div>
                            <div
                              style={{
                                textAlign: 'start',
                                position: 'relative',
                                width: '350px',
                                height: '30px',
                                backgroundColor: '#f0f1f1',
                              }}
                            >
                              <span
                                style={{
                                  fontSize: '11px',
                                  lineHeight: '30px',
                                  padding: '20px',
                                }}
                                id={item.pathString}
                              >
                                {item.cssVariableName}
                              </span>
                              <div
                                style={{
                                  margin: '0',
                                  position: 'absolute',
                                  top: '50%',
                                  right: '5px',
                                  msTransform: 'translateY(-50%)',
                                  transform: 'translateY(-50%)',
                                }}
                              >
                                <button
                                  style={{
                                    border: '1px solid #f0f1f1',
                                    borderRadius: '4px',
                                    padding: '1px 3px 1px 3px',
                                  }}
                                  onClick={() => {
                                    navigator.clipboard.writeText(
                                      item.cssVariableName
                                    );
                                  }}
                                >
                                  <scale-icon-action-copy-paste
                                    size={15}
                                    accessibility-title="copy-paste"
                                  />
                                </button>
                              </div>
                            </div>
                            <div
                              style={{
                                padding: '10px 0 0 0',
                                fontWeight: '500',
                                fontSize: '13px',
                              }}
                            >
                              js
                            </div>
                            <div
                              style={{
                                textAlign: 'start',
                                position: 'relative',
                                width: '350px',
                                height: '30px',
                                backgroundColor: '#f0f1f1',
                              }}
                            >
                              <span
                                style={{
                                  fontSize: '11px',
                                  lineHeight: '30px',
                                  padding: '20px',
                                }}
                                id={item.pathString}
                              >
                                {item.jsPathName}
                              </span>
                            </div>
                            <div
                              style={{
                                padding: '10px 0 0 0',
                                fontWeight: '500',
                                fontSize: '13px',
                              }}
                            >
                              hex
                            </div>
                            <div
                              style={{
                                textAlign: 'start',
                                position: 'relative',
                                width: '350px',
                                height: '30px',
                                backgroundColor: '#f0f1f1',
                              }}
                            >
                              <span
                                style={{
                                  fontSize: '11px',
                                  lineHeight: '30px',
                                  padding: '20px',
                                }}
                                id={item.pathString}
                              >
                                {item.value}
                              </span>
                            </div>
                          </td>
                        </tr>
                      </tbody>
                    </div>
                  );
                })}
            </table>
          </DocsContainer>
        );
      },
    },
  }}
/>
