import { Meta, Description, DocsContainer } from '@storybook/addon-docs/blocks';
import lightTokens from '../telekom-design-tokens.light.json';
import darkTokens from '../telekom-design-tokens.dark.json';

import text_en from './5.Colors_en.md';
import text_de from './5.Colors_de.md';

<Meta
  title="Scale for Designers/Colors"
  parameters={{
    docs: {
      container: ({ context }) => {
        const tinycolor = require('tinycolor2');
        const locale = context && context.globals && context.globals.locale;
        const colorMode =
          context && context.globals && context.globals.colorMode;
        const allTokens = colorMode === 'light' ? lightTokens : darkTokens;
        const darkMode = colorMode === 'light' ? false : true;
        let pathStringItem = [];
        let levelStringItem = [];
        let currentSection;
        let cleared = false;
        let item = getItemByPathString('color.text-&-icon.functional.warning');
        let contrastSections;
        function getItemPathByPath(path) {
          for (let i = 0; i < allTokens.tokens.length; i++) {
            if (allTokens.tokens[i].pathString === path) {
              if (allTokens.tokens[i].path[3]) {
                return (
                  allTokens.tokens[i].path[2] +
                  ' / ' +
                  allTokens.tokens[i].path[3]
                );
              }
              return allTokens.tokens[i].path[2];
            }
          }
        }
        function getItemColorByPath(path) {
          for (let i = 0; i < allTokens.tokens.length; i++) {
            if (allTokens.tokens[i].pathString === path) {
              return allTokens.tokens[i].value;
            }
          }
        }
        function getLevelByPath(path) {
          for (let i = 0; i < levelStringItem.length; i++) {
            let currentItem = levelStringItem[i];
            let splittedItem = currentItem.split('/');
            if (splittedItem[0] === path) {
              return splittedItem[1];
            }
          }
        }
        function getItemByPathString(pathString) {
          for (let i = 0; i < allTokens.tokens.length; i++) {
            let currentItem = allTokens.tokens[i];
            if (currentItem.pathString === pathString) {
              return currentItem;
            }
          }
        }
        function getAllSections(items) {
          let itemPaths = [];
          let sections = [];
          let currentSection;
          items.map((path) => itemPaths.push(getItemPathByPath(path)));
          for (let i = 0; i < itemPaths.length; i++) {
            if (itemPaths[i].includes('/')) {
              if (sections.length == 0) {
                currentSection = itemPaths[i].substr(
                  0,
                  itemPaths[i].indexOf('/')
                );
                sections.push(
                  itemPaths[i].substr(0, itemPaths[i].indexOf('/'))
                );
              } else {
                if (
                  currentSection !==
                  itemPaths[i].substr(0, itemPaths[i].indexOf('/'))
                ) {
                  sections.push(
                    itemPaths[i].substr(0, itemPaths[i].indexOf('/'))
                  );
                  currentSection = itemPaths[i].substr(
                    0,
                    itemPaths[i].indexOf('/')
                  );
                }
              }
            }
          }
          contrastSections = sections;
        }
        function hasContrastWithoutSlash(items) {
          let itemPaths = [];
          items.map((item) => {
            itemPaths.push(getItemPathByPath(item));
          });
          for (let i = 0; i < itemPaths.length; i++) {
            if (!itemPaths[i].includes('/')) {
              return true;
            }
          }
        }
        function setContrastStates() {
          item.contrastChecks
            ? item.contrastChecks.map((contrastCkeckItem) => {
                pathStringItem.push(contrastCkeckItem.path);
                levelStringItem.push(
                  contrastCkeckItem.path + '/' + contrastCkeckItem.level
                );
              })
            : null;
        }
        function clearContrastStates() {
          pathStringItem.length = 0;
          levelStringItem.length = 0;
          cleared = true;
        }
        function generateColorRow(itemPathString) {
          item = getItemByPathString(itemPathString);
          return (
            <tr>
              {/* Example Column */}
              <td
                style={{
                  border: 'none',
                  verticalAlign: 'top',
                  width: '200px',
                  padding: '5px 5px 5px 0',
                }}
              >
                {clearContrastStates()}
                {cleared ? setContrastStates() : null}
                {item.contrastChecks ? (
                  <div
                    style={{
                      backgroundColor: `${item.value}`,
                      padding: '20px',
                      marginTop: '10px',
                      border: `${
                        darkMode ? '1px solid #38393b' : '1px solid #f0f1f1'
                      }`,
                      borderRadius: '4px',
                      minWidth: '380px',
                      minHeight: '120px',
                    }}
                  >
                    <div
                      style={{
                        color: `${getItemColorByPath(pathStringItem[0])}`,
                        fontSize: '9px',
                        padding: '0px 0px 5px 0px',
                      }}
                    >
                      Recommended colors for text & icons
                    </div>
                    {hasContrastWithoutSlash(pathStringItem) ? (
                      <td
                        style={{
                          padding: '0px 18px 0px 0px',
                          border: 'none',
                        }}
                      >
                        {pathStringItem
                          .filter(
                            (path) => !getItemPathByPath(path).includes('/')
                          )
                          .map((path) => {
                            return (
                              <a href={`#${path}`}>
                                <div
                                  style={{
                                    color: `${getItemColorByPath(path)}`,
                                    fontSize: '11px',
                                  }}
                                >
                                  {getItemPathByPath(path)}
                                  {' (' + getLevelByPath(path) + ')'}
                                </div>
                              </a>
                            );
                          })}
                      </td>
                    ) : null}
                    {getAllSections(pathStringItem)}
                    {contrastSections
                      ? contrastSections.map((item, i) => {
                          return (
                            <td
                              style={{
                                border: 'none',
                                padding: '0px 18px 0px 0px',
                              }}
                            >
                              {pathStringItem
                                .filter((path) =>
                                  getItemPathByPath(path).includes(
                                    `${contrastSections[i]}`
                                  )
                                )
                                .map((path) => {
                                  return (
                                    <a href={`#${path}`}>
                                      <div
                                        style={{
                                          color: `${getItemColorByPath(path)}`,
                                          fontSize: '11px',
                                        }}
                                      >
                                        {getItemPathByPath(path)}
                                        {'(' + getLevelByPath(path) + ')'}
                                      </div>
                                    </a>
                                  );
                                })}
                            </td>
                          );
                        })
                      : null}
                  </div>
                ) : (
                  <div
                    style={{
                      backgroundColor: `${item.value}`,
                      padding: '20px',
                      marginTop: '10px',
                      border: `${
                        darkMode ? '1px solid #38393b' : '1px solid #f0f1f1'
                      }`,
                      borderRadius: '4px',
                      width: '380px',
                      minHeight: '120px',
                    }}
                  ></div>
                )}
              </td>
              {/* Description Column */}
              <td
                style={{
                  verticalAlign: 'top',
                  width: '00px',
                  height: 'inherit',
                  border: 'none',
                }}
              >
                <div
                  style={{
                    marginTop: '7px',
                    marginBottom: '7px',
                    width: '400px',
                  }}
                >
                  <div>
                    <span
                      style={{
                        fontWeight: 'bolder',
                        fontSize: '18px',
                        color: `${darkMode ? '#fff' : '#000'}`,
                      }}
                    >
                      {item.name}
                    </span>
                  </div>
                  <div>
                    <span
                      style={{
                        fontSize: '14px',
                        color: `${darkMode ? '#fff' : '#000'}`,
                      }}
                    >
                      {item.comment}
                    </span>
                  </div>
                </div>
              </td>
              {/* Token Name Column */}
              <td
                style={{
                  verticalAlign: 'top',
                  border: 'none',
                  padding: '10px 0 10px 0',
                }}
              >
                <div
                  style={{
                    fontWeight: '500',
                    fontSize: '13px',
                    color: `${darkMode ? '#fff' : '#000'}`,
                  }}
                >
                  css
                </div>
                <div
                  style={{
                    textAlign: 'start',
                    position: 'relative',
                    width: '350px',
                    height: '30px',
                    backgroundColor: `${darkMode ? '#38393b' : '#f0f1f1'}`,
                  }}
                >
                  <span
                    style={{
                      fontSize: '11px',
                      lineHeight: '30px',
                      padding: '20px',
                      color: `${darkMode ? '#fff' : '#6A6A6A'}`,
                    }}
                    id={item.pathString}
                  >
                    {item.cssVariableName}
                  </span>
                  <div
                    style={{
                      margin: '0',
                      position: 'absolute',
                      top: '50%',
                      right: '5px',
                      msTransform: 'translateY(-50%)',
                      transform: 'translateY(-50%)',
                    }}
                  >
                    <button
                      class="color_token_copy-paste-button"
                      style={{
                        border: `${
                          darkMode ? '1px solid #38393b' : '1px solid #f0f1f1'
                        }`,
                        borderRadius: '4px',
                        padding: '1px 3px 1px 3px',
                        cursor: 'pointer',
                        backgroundColor: `${darkMode ? '#38393b' : '#f0f1f1'}`,
                      }}
                      onClick={() => {
                        navigator.clipboard.writeText(item.cssVariableName);
                      }}
                    >
                      <scale-icon-action-copy-paste
                        size={15}
                        accessibility-title="copy-paste"
                      />
                    </button>
                  </div>
                </div>
                <div
                  style={{
                    padding: '10px 0 0 0',
                    fontWeight: '500',
                    fontSize: '13px',
                    color: `${darkMode ? '#fff' : '#000'}`,
                  }}
                >
                  js
                </div>
                <div
                  style={{
                    textAlign: 'start',
                    position: 'relative',
                    width: '350px',
                    height: '30px',
                    backgroundColor: `${darkMode ? '#38393b' : '#f0f1f1'}`,
                  }}
                >
                  <span
                    style={{
                      fontSize: '11px',
                      lineHeight: '30px',
                      padding: '20px',
                      color: `${darkMode ? '#fff' : '#6A6A6A'}`,
                    }}
                    id={item.pathString}
                  >
                    {item.jsPathName}
                  </span>
                  <div
                    style={{
                      margin: '0',
                      position: 'absolute',
                      top: '50%',
                      right: '5px',
                      msTransform: 'translateY(-50%)',
                      transform: 'translateY(-50%)',
                    }}
                  >
                    <button
                      class="color_token_copy-paste-button"
                      style={{
                        border: `${
                          darkMode ? '1px solid #38393b' : '1px solid #f0f1f1'
                        }`,
                        borderRadius: '4px',
                        padding: '1px 3px 1px 3px',
                        cursor: 'pointer',
                        backgroundColor: `${darkMode ? '#38393b' : '#f0f1f1'}`,
                      }}
                      onClick={() => {
                        navigator.clipboard.writeText(item.jsPathName);
                      }}
                    >
                      <scale-icon-action-copy-paste
                        size={15}
                        accessibility-title="copy-paste"
                      />
                    </button>
                  </div>
                </div>
                <div
                  style={{
                    padding: '10px 0 0 0',
                    fontWeight: '500',
                    fontSize: '13px',
                    color: `${darkMode ? '#fff' : '#000'}`,
                  }}
                >
                  hex
                </div>
                <div
                  style={{
                    textAlign: 'start',
                    position: 'relative',
                    width: '350px',
                    height: '30px',
                    backgroundColor: `${darkMode ? '#38393b' : '#f0f1f1'}`,
                  }}
                >
                  <span
                    style={{
                      fontSize: '11px',
                      lineHeight: '30px',
                      padding: '20px',
                      color: `${darkMode ? '#fff' : '#6A6A6A'}`,
                    }}
                    id={item.pathString}
                  >
                    {item.value}
                  </span>
                </div>
              </td>
            </tr>
          );
        }
        function generateTableHead() {
          return (
            <thead>
              <tr>
                <th
                  style={{
                    textAlign: 'left',
                    color: `${darkMode ? '#fff' : '#6A6A6A'}`,
                    fontSize: '13px',
                    borderColor: '#fff',
                    borderBottom: '1px solid #E7E8E9',
                    padding: '0',
                  }}
                >
                  Example
                </th>
                <th
                  style={{
                    textAlign: 'left',
                    color: `${darkMode ? '#fff' : '#6A6A6A'}`,
                    fontSize: '13px',
                    borderColor: '#fff',
                    borderBottom: '1px solid #E7E8E9',
                  }}
                >
                  Description
                </th>
                <th
                  style={{
                    textAlign: 'left',
                    color: `${darkMode ? '#fff' : '#6A6A6A'}`,
                    fontSize: '13px',
                    borderColor: '#fff',
                    borderBottom: '1px solid #E7E8E9',
                    padding: '0',
                  }}
                >
                  Token Name
                </th>
              </tr>
            </thead>
          );
        }
        return (
          <DocsContainer context={context}>
            <Description markdown={locale === 'en' ? text_en : text_de} />
            <table style={{ backgroundColor: `${darkMode ? '#000' : '#fff'}` }}>
              <div>
                <div
                  style={{
                    marginTop: '100px',
                    marginBottom: '50px',
                    fontWeight: 'bold',
                    fontSize: '30px',
                    color: `${darkMode ? '#fff' : '#000'}`,
                  }}
                >
                  Primary Colors
                </div>
                {generateTableHead()}
                <tbody>
                  {generateColorRow('color.primary.standard')}
                  {generateColorRow('color.background.surface')}
                  {generateColorRow('color.text-&-icon.additional')}
                </tbody>
              </div>
            </table>
          </DocsContainer>
        );
      },
    },
  }}
/>
